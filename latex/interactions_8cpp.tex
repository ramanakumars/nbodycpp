\doxysection{src/interactions.cpp File Reference}
\hypertarget{interactions_8cpp}{}\label{interactions_8cpp}\index{src/interactions.cpp@{src/interactions.cpp}}


Implementation of particle interactions and collision handling.  


{\ttfamily \#include "{}RK2.\+h"{}}\newline
{\ttfamily \#include "{}hermite.\+h"{}}\newline
{\ttfamily \#include "{}interactions.\+h"{}}\newline
{\ttfamily \#include "{}yoshida.\+h"{}}\newline
Include dependency graph for interactions.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interactions_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{interactions_8cpp_ad6ed62bcd83f7e804a857b133c7a1068}{update\+Particles}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&particles, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{dt}})
\begin{DoxyCompactList}\small\item\em Main particle update\+: integrate and handle collisions. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{interactions_8cpp_a442ab3f0237d06bdddf96b5bb372c031}{transport\+Step}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&particles, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{dt}})
\begin{DoxyCompactList}\small\item\em Dispatch to selected integrator. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classvector2D}{vector2D}} \mbox{\hyperlink{interactions_8cpp_a7954b89f6f177441a579fdcd11dd46ed}{calc\+Mutual\+Acceleration}} (\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classQuadTree}{p1}}, \mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classQuadTree}{p2}})
\begin{DoxyCompactList}\small\item\em Calculate relative gravitational acceleration for collision prediction. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structCollisionInfo}{Collision\+Info}} \mbox{\hyperlink{interactions_8cpp_a97537fab4566bf53acdc825abb69a5b2}{predict\+Collision}} (\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classQuadTree}{p1}}, \mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classQuadTree}{p2}}, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{dt}})
\begin{DoxyCompactList}\small\item\em Predict if and when two particles will collide. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{interactions_8cpp_a07cfc5b5a1c164dc3bd1ca7bb13ede40}{check\+Collisions}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&particles, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{dt}})
\begin{DoxyCompactList}\small\item\em Detect and resolve particle collisions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{global_8h_a86cdaffc49feb3f5e3f1ffacfc054427}{transport\+\_\+type}} \mbox{\hyperlink{interactions_8cpp_a55dbb916b6100c51eb7e599ccba7a502}{TRANSPORT\+\_\+\+TYPE}} = \mbox{\hyperlink{global_8h_a86cdaffc49feb3f5e3f1ffacfc054427a88e4c6a7dff57eb6f1f838c4eb8844a2}{transport\+\_\+type\+::\+HERMITE}}
\begin{DoxyCompactList}\small\item\em Selected integrator (default\+: Hermite 4th order) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of particle interactions and collision handling. 



\doxysubsection{Function Documentation}
\Hypertarget{interactions_8cpp_a7954b89f6f177441a579fdcd11dd46ed}\label{interactions_8cpp_a7954b89f6f177441a579fdcd11dd46ed} 
\index{interactions.cpp@{interactions.cpp}!calcMutualAcceleration@{calcMutualAcceleration}}
\index{calcMutualAcceleration@{calcMutualAcceleration}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{calcMutualAcceleration()}{calcMutualAcceleration()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classvector2D}{vector2D}} calc\+Mutual\+Acceleration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p1,  }\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p2 }\end{DoxyParamCaption})}



Calculate relative gravitational acceleration for collision prediction. 

Computes acceleration of p1 relative to p2 in their mutual frame. Used for trajectory prediction in continuous collision detection.


\begin{DoxyParams}{Parameters}
{\em p1} & First particle \\
\hline
{\em p2} & Second particle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Relative acceleration vector 
\end{DoxyReturn}
\Hypertarget{interactions_8cpp_a07cfc5b5a1c164dc3bd1ca7bb13ede40}\label{interactions_8cpp_a07cfc5b5a1c164dc3bd1ca7bb13ede40} 
\index{interactions.cpp@{interactions.cpp}!checkCollisions@{checkCollisions}}
\index{checkCollisions@{checkCollisions}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{checkCollisions()}{checkCollisions()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} check\+Collisions (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



Detect and resolve particle collisions. 

Uses quadtree spatial partitioning and continuous collision detection to find colliding particles. Merges particles via perfectly inelastic collisions, conserving momentum and mass.

Features\+:
\begin{DoxyItemize}
\item Velocity-\/aware search radius
\item Continuous collision detection (accounts for gravitational trajectories)
\item Thread-\/safe with directional merging (ID-\/based)
\item Removes merged particles from simulation
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em particles} & \doxylink{classParticle}{Particle} vector (modified in-\/place) \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} for spatial queries \\
\hline
{\em dt} & Timestep (for continuous collision detection)\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Parallelized with Open\+MP 

Uses race-\/condition prevention via ID ordering 
\end{DoxyNote}
\Hypertarget{interactions_8cpp_a97537fab4566bf53acdc825abb69a5b2}\label{interactions_8cpp_a97537fab4566bf53acdc825abb69a5b2} 
\index{interactions.cpp@{interactions.cpp}!predictCollision@{predictCollision}}
\index{predictCollision@{predictCollision}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{predictCollision()}{predictCollision()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structCollisionInfo}{Collision\+Info}} predict\+Collision (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p1,  }\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p2,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



Predict if and when two particles will collide. 

Uses continuous collision detection with gravitational trajectory approximation. Samples the quadratic trajectory (constant acceleration) to find minimum approach distance and collision time.

Trajectory model\+: r(t) = r₀ + v₀\texorpdfstring{$\ast$}{*}t + ½\texorpdfstring{$\ast$}{*}a\texorpdfstring{$\ast$}{*}t²


\begin{DoxyParams}{Parameters}
{\em p1} & First particle \\
\hline
{\em p2} & Second particle \\
\hline
{\em dt} & Timestep to check within \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\doxylink{structCollisionInfo}{Collision\+Info} structure with prediction results
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Uses constant acceleration approximation 

Includes gravitational effects in trajectory 

Samples trajectory at multiple points for accuracy 
\end{DoxyNote}
\Hypertarget{interactions_8cpp_a442ab3f0237d06bdddf96b5bb372c031}\label{interactions_8cpp_a442ab3f0237d06bdddf96b5bb372c031} 
\index{interactions.cpp@{interactions.cpp}!transportStep@{transportStep}}
\index{transportStep@{transportStep}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{transportStep()}{transportStep()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} transport\+Step (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



Dispatch to selected integrator. 

Perform one integration timestep using selected integrator. \Hypertarget{interactions_8cpp_ad6ed62bcd83f7e804a857b133c7a1068}\label{interactions_8cpp_ad6ed62bcd83f7e804a857b133c7a1068} 
\index{interactions.cpp@{interactions.cpp}!updateParticles@{updateParticles}}
\index{updateParticles@{updateParticles}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{updateParticles()}{updateParticles()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} update\+Particles (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



Main particle update\+: integrate and handle collisions. 

Main update function\+: integrate and handle collisions. 

\doxysubsection{Variable Documentation}
\Hypertarget{interactions_8cpp_a55dbb916b6100c51eb7e599ccba7a502}\label{interactions_8cpp_a55dbb916b6100c51eb7e599ccba7a502} 
\index{interactions.cpp@{interactions.cpp}!TRANSPORT\_TYPE@{TRANSPORT\_TYPE}}
\index{TRANSPORT\_TYPE@{TRANSPORT\_TYPE}!interactions.cpp@{interactions.cpp}}
\doxysubsubsection{\texorpdfstring{TRANSPORT\_TYPE}{TRANSPORT\_TYPE}}
{\footnotesize\ttfamily \mbox{\hyperlink{global_8h_a86cdaffc49feb3f5e3f1ffacfc054427}{transport\+\_\+type}} TRANSPORT\+\_\+\+TYPE = \mbox{\hyperlink{global_8h_a86cdaffc49feb3f5e3f1ffacfc054427a88e4c6a7dff57eb6f1f838c4eb8844a2}{transport\+\_\+type\+::\+HERMITE}}}



Selected integrator (default\+: Hermite 4th order) 

Global integrator selection. 
