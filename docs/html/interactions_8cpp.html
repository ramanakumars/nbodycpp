<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nbodycpp: src/interactions.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nbodycpp<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">N-body solver with a QuadTree and Barnes-Hut algorithm written in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">interactions.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of particle interactions and collision handling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="RK2_8h_source.html">RK2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hermite_8h_source.html">hermite.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interactions_8h_source.html">interactions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="yoshida_8h_source.html">yoshida.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for interactions.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="interactions_8cpp__incl.png" border="0" usemap="#asrc_2interactions_8cpp" alt=""/></div>
<map name="asrc_2interactions_8cpp" id="asrc_2interactions_8cpp">
<area shape="rect" title="Implementation of particle interactions and collision handling." alt="" coords="338,5,487,31"/>
<area shape="rect" href="RK2_8h.html" title="Second&#45;order Runge&#45;Kutta (RK2) integrator." alt="" coords="245,79,305,104"/>
<area shape="poly" title=" " alt="" coords="392,33,311,75,309,70,389,28"/>
<area shape="rect" href="hermite_8h.html" title="Hermite 4th order predictor&#45;corrector integrator for N&#45;body simulations." alt="" coords="437,152,522,177"/>
<area shape="poly" title=" " alt="" coords="421,30,471,138,466,141,416,32"/>
<area shape="rect" href="interactions_8h.html" title="Particle interactions including integration and collision handling." alt="" coords="547,152,657,177"/>
<area shape="poly" title=" " alt="" coords="430,29,578,142,574,146,427,33"/>
<area shape="rect" href="yoshida_8h.html" title="Yoshida 4th order symplectic integrator." alt="" coords="330,79,415,104"/>
<area shape="poly" title=" " alt="" coords="408,32,388,68,384,65,404,30"/>
<area shape="rect" href="barneshut_8h.html" title="Barnes&#45;Hut algorithm for hierarchical N&#45;body force calculation." alt="" coords="314,152,413,177"/>
<area shape="poly" title=" " alt="" coords="291,102,340,141,337,145,288,106"/>
<area shape="rect" href="global_8h.html" title="Global constants, includes, and type definitions for N&#45;body simulation." alt="" coords="391,445,466,471"/>
<area shape="poly" title=" " alt="" coords="271,105,245,161,233,198,229,237,229,312,233,338,244,361,260,380,281,398,330,424,379,442,377,447,328,429,278,402,256,384,239,364,228,340,223,313,223,237,228,197,240,159,266,103"/>
<area shape="poly" title=" " alt="" coords="366,177,369,250,381,325,403,396,419,432,414,434,398,398,376,326,363,251,360,178"/>
<area shape="rect" href="quadtree_8h.html" title="QuadTree spatial data structure for Barnes&#45;Hut algorithm." alt="" coords="377,225,469,251"/>
<area shape="poly" title=" " alt="" coords="375,176,407,213,403,217,371,179"/>
<area shape="rect" href="particle_8h.html" title="Particle class for N&#45;body simulation." alt="" coords="494,225,577,251"/>
<area shape="poly" title=" " alt="" coords="392,175,496,218,494,222,390,180"/>
<area shape="rect" title=" " alt="" coords="5,519,71,544"/>
<area shape="poly" title=" " alt="" coords="392,467,260,488,85,521,84,516,259,483,391,462"/>
<area shape="rect" title=" " alt="" coords="95,519,157,544"/>
<area shape="poly" title=" " alt="" coords="392,470,171,521,169,516,391,465"/>
<area shape="rect" title=" " alt="" coords="181,519,244,544"/>
<area shape="poly" title=" " alt="" coords="395,473,258,518,256,513,393,468"/>
<area shape="rect" title=" " alt="" coords="268,519,331,544"/>
<area shape="poly" title=" " alt="" coords="409,473,334,514,332,509,407,468"/>
<area shape="rect" title=" " alt="" coords="355,519,411,544"/>
<area shape="poly" title=" " alt="" coords="423,472,400,509,396,506,419,470"/>
<area shape="rect" title=" " alt="" coords="435,519,513,544"/>
<area shape="poly" title=" " alt="" coords="438,470,462,506,457,509,434,472"/>
<area shape="rect" title=" " alt="" coords="537,519,617,544"/>
<area shape="poly" title=" " alt="" coords="454,468,541,510,539,515,451,473"/>
<area shape="rect" title=" " alt="" coords="641,519,726,544"/>
<area shape="poly" title=" " alt="" coords="467,467,630,512,628,517,466,472"/>
<area shape="rect" title=" " alt="" coords="750,519,865,544"/>
<area shape="poly" title=" " alt="" coords="467,464,736,514,736,519,466,469"/>
<area shape="rect" title=" " alt="" coords="889,519,952,544"/>
<area shape="poly" title=" " alt="" coords="466,460,639,479,755,496,876,516,875,521,754,501,639,485,466,465"/>
<area shape="poly" title=" " alt="" coords="421,252,407,299,405,335,409,371,423,432,418,433,404,372,400,335,402,298,416,250"/>
<area shape="rect" href="bounds_8h.html" title="Axis&#45;aligned bounding box for spatial queries." alt="" coords="416,299,497,324"/>
<area shape="poly" title=" " alt="" coords="431,250,448,285,443,287,426,252"/>
<area shape="poly" title=" " alt="" coords="457,325,436,432,431,431,452,324"/>
<area shape="rect" href="vector2D_8h.html" title="2D vector class for N&#45;body simulation" alt="" coords="466,372,559,397"/>
<area shape="poly" title=" " alt="" coords="468,323,497,360,493,363,464,326"/>
<area shape="poly" title=" " alt="" coords="501,399,455,438,451,434,497,395"/>
<area shape="poly" title=" " alt="" coords="546,249,562,277,579,316,586,358,583,379,574,399,555,419,531,435,480,452,479,447,529,430,551,415,569,396,577,378,580,358,574,317,558,280,541,252"/>
<area shape="poly" title=" " alt="" coords="524,253,481,291,478,288,521,249"/>
<area shape="poly" title=" " alt="" coords="536,252,519,359,514,358,531,251"/>
<area shape="poly" title=" " alt="" coords="522,175,560,194,577,207,591,224,615,270,626,312,625,333,620,354,596,399,572,423,543,439,511,450,480,456,479,451,510,445,541,435,569,419,592,396,615,352,620,332,621,312,610,272,586,227,573,211,557,198,520,180"/>
<area shape="poly" title=" " alt="" coords="472,179,443,216,439,213,468,176"/>
<area shape="poly" title=" " alt="" coords="491,176,520,213,516,216,486,179"/>
<area shape="poly" title=" " alt="" coords="611,177,629,218,646,278,650,311,648,343,639,373,621,399,589,424,553,440,515,451,480,456,479,451,514,446,551,435,587,419,617,395,635,371,643,342,645,311,641,279,624,220,606,179"/>
<area shape="poly" title=" " alt="" coords="574,180,466,223,464,218,572,175"/>
<area shape="poly" title=" " alt="" coords="593,179,557,217,554,213,589,176"/>
<area shape="poly" title=" " alt="" coords="374,105,369,139,364,138,368,104"/>
<area shape="poly" title=" " alt="" coords="355,106,329,126,304,154,284,193,279,237,279,312,282,334,290,354,317,389,353,417,389,437,386,442,350,421,313,393,285,357,277,335,274,313,274,237,279,191,300,150,325,122,352,102"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad6ed62bcd83f7e804a857b133c7a1068" id="r_ad6ed62bcd83f7e804a857b133c7a1068"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#ad6ed62bcd83f7e804a857b133c7a1068">updateParticles</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;particles, <a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *tree, <a class="el" href="classQuadTree.html">double</a> <a class="el" href="classQuadTree.html">dt</a>)</td></tr>
<tr class="memdesc:ad6ed62bcd83f7e804a857b133c7a1068"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main particle update: integrate and handle collisions.  <br /></td></tr>
<tr class="separator:ad6ed62bcd83f7e804a857b133c7a1068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442ab3f0237d06bdddf96b5bb372c031" id="r_a442ab3f0237d06bdddf96b5bb372c031"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#a442ab3f0237d06bdddf96b5bb372c031">transportStep</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;particles, <a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *tree, <a class="el" href="classQuadTree.html">double</a> <a class="el" href="classQuadTree.html">dt</a>)</td></tr>
<tr class="memdesc:a442ab3f0237d06bdddf96b5bb372c031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch to selected integrator.  <br /></td></tr>
<tr class="separator:a442ab3f0237d06bdddf96b5bb372c031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7954b89f6f177441a579fdcd11dd46ed" id="r_a7954b89f6f177441a579fdcd11dd46ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvector2D.html">vector2D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#a7954b89f6f177441a579fdcd11dd46ed">calcMutualAcceleration</a> (<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *<a class="el" href="classQuadTree.html">p1</a>, <a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *<a class="el" href="classQuadTree.html">p2</a>)</td></tr>
<tr class="memdesc:a7954b89f6f177441a579fdcd11dd46ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate relative gravitational acceleration for collision prediction.  <br /></td></tr>
<tr class="separator:a7954b89f6f177441a579fdcd11dd46ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97537fab4566bf53acdc825abb69a5b2" id="r_a97537fab4566bf53acdc825abb69a5b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structCollisionInfo.html">CollisionInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#a97537fab4566bf53acdc825abb69a5b2">predictCollision</a> (<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *<a class="el" href="classQuadTree.html">p1</a>, <a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *<a class="el" href="classQuadTree.html">p2</a>, <a class="el" href="classQuadTree.html">double</a> <a class="el" href="classQuadTree.html">dt</a>)</td></tr>
<tr class="memdesc:a97537fab4566bf53acdc825abb69a5b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict if and when two particles will collide.  <br /></td></tr>
<tr class="separator:a97537fab4566bf53acdc825abb69a5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07cfc5b5a1c164dc3bd1ca7bb13ede40" id="r_a07cfc5b5a1c164dc3bd1ca7bb13ede40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#a07cfc5b5a1c164dc3bd1ca7bb13ede40">checkCollisions</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;particles, <a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *tree, <a class="el" href="classQuadTree.html">double</a> <a class="el" href="classQuadTree.html">dt</a>)</td></tr>
<tr class="memdesc:a07cfc5b5a1c164dc3bd1ca7bb13ede40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect and resolve particle collisions.  <br /></td></tr>
<tr class="separator:a07cfc5b5a1c164dc3bd1ca7bb13ede40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a55dbb916b6100c51eb7e599ccba7a502" id="r_a55dbb916b6100c51eb7e599ccba7a502"><td class="memItemLeft" align="right" valign="top"><a class="el" href="global_8h.html#a86cdaffc49feb3f5e3f1ffacfc054427">transport_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interactions_8cpp.html#a55dbb916b6100c51eb7e599ccba7a502">TRANSPORT_TYPE</a> = <a class="el" href="global_8h.html#a86cdaffc49feb3f5e3f1ffacfc054427a88e4c6a7dff57eb6f1f838c4eb8844a2">transport_type::HERMITE</a></td></tr>
<tr class="memdesc:a55dbb916b6100c51eb7e599ccba7a502"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selected integrator (default: Hermite 4th order)  <br /></td></tr>
<tr class="separator:a55dbb916b6100c51eb7e599ccba7a502"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of particle interactions and collision handling. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7954b89f6f177441a579fdcd11dd46ed" name="a7954b89f6f177441a579fdcd11dd46ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7954b89f6f177441a579fdcd11dd46ed">&#9670;&#160;</a></span>calcMutualAcceleration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classvector2D.html">vector2D</a> calcMutualAcceleration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate relative gravitational acceleration for collision prediction. </p>
<p>Computes acceleration of p1 relative to p2 in their mutual frame. Used for trajectory prediction in continuous collision detection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p1</td><td>First particle </td></tr>
    <tr><td class="paramname">p2</td><td>Second particle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Relative acceleration vector </dd></dl>

</div>
</div>
<a id="a07cfc5b5a1c164dc3bd1ca7bb13ede40" name="a07cfc5b5a1c164dc3bd1ca7bb13ede40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07cfc5b5a1c164dc3bd1ca7bb13ede40">&#9670;&#160;</a></span>checkCollisions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> checkCollisions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detect and resolve particle collisions. </p>
<p>Uses quadtree spatial partitioning and continuous collision detection to find colliding particles. Merges particles via perfectly inelastic collisions, conserving momentum and mass.</p>
<p>Features:</p><ul>
<li>Velocity-aware search radius</li>
<li>Continuous collision detection (accounts for gravitational trajectories)</li>
<li>Thread-safe with directional merging (ID-based)</li>
<li>Removes merged particles from simulation</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td><a class="el" href="classParticle.html" title="Represents a particle in the N-body simulation.">Particle</a> vector (modified in-place) </td></tr>
    <tr><td class="paramname">tree</td><td><a class="el" href="classQuadTree.html" title="Hierarchical spatial partitioning tree for 2D N-body simulation.">QuadTree</a> for spatial queries </td></tr>
    <tr><td class="paramname">dt</td><td>Timestep (for continuous collision detection)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Parallelized with OpenMP </dd>
<dd>
Uses race-condition prevention via ID ordering </dd></dl>

</div>
</div>
<a id="a97537fab4566bf53acdc825abb69a5b2" name="a97537fab4566bf53acdc825abb69a5b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97537fab4566bf53acdc825abb69a5b2">&#9670;&#160;</a></span>predictCollision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structCollisionInfo.html">CollisionInfo</a> predictCollision </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">const</a> <a class="el" href="classParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predict if and when two particles will collide. </p>
<p>Uses continuous collision detection with gravitational trajectory approximation. Samples the quadratic trajectory (constant acceleration) to find minimum approach distance and collision time.</p>
<p>Trajectory model: r(t) = r₀ + v₀*t + ½*a*t²</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p1</td><td>First particle </td></tr>
    <tr><td class="paramname">p2</td><td>Second particle </td></tr>
    <tr><td class="paramname">dt</td><td>Timestep to check within </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structCollisionInfo.html" title="Result of collision prediction between two particles.">CollisionInfo</a> structure with prediction results</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Uses constant acceleration approximation </dd>
<dd>
Includes gravitational effects in trajectory </dd>
<dd>
Samples trajectory at multiple points for accuracy </dd></dl>

</div>
</div>
<a id="a442ab3f0237d06bdddf96b5bb372c031" name="a442ab3f0237d06bdddf96b5bb372c031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442ab3f0237d06bdddf96b5bb372c031">&#9670;&#160;</a></span>transportStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> transportStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch to selected integrator. </p>
<p>Perform one integration timestep using selected integrator. </p>

</div>
</div>
<a id="ad6ed62bcd83f7e804a857b133c7a1068" name="ad6ed62bcd83f7e804a857b133c7a1068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6ed62bcd83f7e804a857b133c7a1068">&#9670;&#160;</a></span>updateParticles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> updateParticles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main particle update: integrate and handle collisions. </p>
<p>Main update function: integrate and handle collisions. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a55dbb916b6100c51eb7e599ccba7a502" name="a55dbb916b6100c51eb7e599ccba7a502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55dbb916b6100c51eb7e599ccba7a502">&#9670;&#160;</a></span>TRANSPORT_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="global_8h.html#a86cdaffc49feb3f5e3f1ffacfc054427">transport_type</a> TRANSPORT_TYPE = <a class="el" href="global_8h.html#a86cdaffc49feb3f5e3f1ffacfc054427a88e4c6a7dff57eb6f1f838c4eb8844a2">transport_type::HERMITE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selected integrator (default: Hermite 4th order) </p>
<p>Global integrator selection. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
