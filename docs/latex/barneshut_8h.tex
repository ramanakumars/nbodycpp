\doxysection{include/barneshut.h File Reference}
\hypertarget{barneshut_8h}{}\label{barneshut_8h}\index{include/barneshut.h@{include/barneshut.h}}


Barnes-\/\+Hut algorithm for hierarchical N-\/body force calculation.  


{\ttfamily \#include "{}global.\+h"{}}\newline
{\ttfamily \#include "{}quadtree.\+h"{}}\newline
{\ttfamily \#include "{}particle.\+h"{}}\newline
Include dependency graph for barneshut.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{barneshut_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{barneshut_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{barneshut_8h_ad7f5038ecd83ebe85c1fa2e1226b875f}{get\+Acceleration}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*})
\begin{DoxyCompactList}\small\item\em Calculate acceleration for all particles using Barnes-\/\+Hut algorithm. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{barneshut_8h_af612fd5497ae8f53ba591a989a527fe9}{force\+And\+Jerk}} (\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}, \mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}, \mbox{\hyperlink{classvector2D}{vector2D}} \&, \mbox{\hyperlink{classvector2D}{vector2D}} \&)
\begin{DoxyCompactList}\small\item\em Calculate gravitational force and jerk between two particles. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{barneshut_8h_adf9382837f326058b8195ada21ce78c8}{Barnes\+Hut\+Force\+And\+Jerk}} (\mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classQuadTree}{p}}, \mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{theta}})
\begin{DoxyCompactList}\small\item\em Recursively calculate force and jerk using Barnes-\/\+Hut tree. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Barnes-\/\+Hut algorithm for hierarchical N-\/body force calculation. 

Implements the Barnes-\/\+Hut tree algorithm for computing gravitational forces in O(\+N log N) time instead of O(N²) for direct summation. 

\doxysubsection{Function Documentation}
\Hypertarget{barneshut_8h_adf9382837f326058b8195ada21ce78c8}\label{barneshut_8h_adf9382837f326058b8195ada21ce78c8} 
\index{barneshut.h@{barneshut.h}!BarnesHutForceAndJerk@{BarnesHutForceAndJerk}}
\index{BarnesHutForceAndJerk@{BarnesHutForceAndJerk}!barneshut.h@{barneshut.h}}
\doxysubsubsection{\texorpdfstring{BarnesHutForceAndJerk()}{BarnesHutForceAndJerk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} Barnes\+Hut\+Force\+And\+Jerk (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p,  }\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{theta }\end{DoxyParamCaption})}



Recursively calculate force and jerk using Barnes-\/\+Hut tree. 

Implements the Barnes-\/\+Hut multipole approximation with jerk calculation. Uses opening angle criterion to determine when to approximate distant particles as a single mass.

Opening criterion\+: s/d \texorpdfstring{$<$}{<} θ
\begin{DoxyItemize}
\item s = cell size
\item d = distance to cell center of mass
\item θ = opening angle (smaller = more accurate)
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em p} & \doxylink{classParticle}{Particle} to calculate forces for \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} node to evaluate \\
\hline
{\em theta} & Opening angle parameter (typical\+: \doxylink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{0.\+05}\doxylink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{-\/0.\+5})\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Accumulates into p-\/\texorpdfstring{$>$}{>}acceleration and p-\/\texorpdfstring{$>$}{>}jerk 

For far-\/field, assumes COM velocity ≈ 0 (simplification)
\end{DoxyNote}
Recursively calculate force and jerk using Barnes-\/\+Hut tree.

Recursively traverses the quadtree, using the multipole approximation when cells are sufficiently distant. Calculates both acceleration and jerk.

Three cases\+:
\begin{DoxyEnumerate}
\item Cell far enough (s \texorpdfstring{$<$}{<} d\texorpdfstring{$\ast$}{*}θ)\+: Use multipole approximation
\item Cell subdivided\+: Recurse into children
\item Leaf node\+: Direct particle-\/particle calculation
\end{DoxyEnumerate}


\begin{DoxyParams}{Parameters}
{\em p} & Target particle \\
\hline
{\em tree} & Current tree node \\
\hline
{\em theta} & Opening angle (accuracy parameter) \\
\hline
\end{DoxyParams}
\Hypertarget{barneshut_8h_af612fd5497ae8f53ba591a989a527fe9}\label{barneshut_8h_af612fd5497ae8f53ba591a989a527fe9} 
\index{barneshut.h@{barneshut.h}!forceAndJerk@{forceAndJerk}}
\index{forceAndJerk@{forceAndJerk}!barneshut.h@{barneshut.h}}
\doxysubsubsection{\texorpdfstring{forceAndJerk()}{forceAndJerk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} force\+And\+Jerk (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p1,  }\item[{\mbox{\hyperlink{classQuadTree}{const}} \mbox{\hyperlink{classParticle}{Particle}} \texorpdfstring{$\ast$}{*}}]{p2,  }\item[{\mbox{\hyperlink{classvector2D}{vector2D}} \&}]{acc\+\_\+out,  }\item[{\mbox{\hyperlink{classvector2D}{vector2D}} \&}]{jerk\+\_\+out }\end{DoxyParamCaption})}



Calculate gravitational force and jerk between two particles. 

Computes both acceleration and its time derivative (jerk) for gravitational interaction between a particle pair.

Formulas\+:
\begin{DoxyItemize}
\item Acceleration\+: a = -\/G\texorpdfstring{$\ast$}{*}m\texorpdfstring{$\ast$}{*}r/\texorpdfstring{$\vert$}{|}r\texorpdfstring{$\vert$}{|}³
\item Jerk\+: da/dt = -\/G\texorpdfstring{$\ast$}{*}m \texorpdfstring{$\ast$}{*} \mbox{[}v/r³ -\/ 3\texorpdfstring{$\ast$}{*}(r·v)\texorpdfstring{$\ast$}{*}r/r⁵\mbox{]}
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
 & {\em p1} & First particle (particle being acted upon) \\
\hline
 & {\em p2} & Second particle (source of force) \\
\hline
\mbox{\texttt{ out}}  & {\em acc\+\_\+out} & Acceleration contribution \\
\hline
\mbox{\texttt{ out}}  & {\em jerk\+\_\+out} & Jerk contribution (time derivative of acceleration)\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Uses gravitational softening based on particle radii
\end{DoxyNote}
Calculate gravitational force and jerk between two particles.

Direct particle-\/particle calculation with softening. Computes both the gravitational force and its time derivative.

The jerk formula comes from differentiating Newton\textquotesingle{}s law\+: d/dt\mbox{[}-\/Gm\texorpdfstring{$\ast$}{*}r/r³\mbox{]} = -\/Gm\texorpdfstring{$\ast$}{*}\mbox{[}v/r³ -\/ 3(r·v)r/r⁵\mbox{]}


\begin{DoxyParams}[1]{Parameters}
 & {\em p1} & \doxylink{classParticle}{Particle} being acted upon \\
\hline
 & {\em p2} & Source particle \\
\hline
\mbox{\texttt{ out}}  & {\em acc\+\_\+out} & Acceleration output \\
\hline
\mbox{\texttt{ out}}  & {\em jerk\+\_\+out} & Jerk output \\
\hline
\end{DoxyParams}
\Hypertarget{barneshut_8h_ad7f5038ecd83ebe85c1fa2e1226b875f}\label{barneshut_8h_ad7f5038ecd83ebe85c1fa2e1226b875f} 
\index{barneshut.h@{barneshut.h}!getAcceleration@{getAcceleration}}
\index{getAcceleration@{getAcceleration}!barneshut.h@{barneshut.h}}
\doxysubsubsection{\texorpdfstring{getAcceleration()}{getAcceleration()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} get\+Acceleration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree }\end{DoxyParamCaption})}



Calculate acceleration for all particles using Barnes-\/\+Hut algorithm. 


\begin{DoxyParams}{Parameters}
{\em particles} & Vector of particles to update \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} structure for hierarchical force calculation\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Zeros acceleration before calculation 

Parallelized with Open\+MP 
\end{DoxyNote}
