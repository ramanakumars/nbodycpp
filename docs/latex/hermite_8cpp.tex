\doxysection{src/hermite.cpp File Reference}
\hypertarget{hermite_8cpp}{}\label{hermite_8cpp}\index{src/hermite.cpp@{src/hermite.cpp}}


Implementation of Hermite 4th order predictor-\/corrector integrator.  


{\ttfamily \#include "{}hermite.\+h"{}}\newline
{\ttfamily \#include "{}barneshut.\+h"{}}\newline
Include dependency graph for hermite.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{hermite_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{hermite_8cpp_a733b75759dd130ce95bc3015d292dea7}{get\+Acceleration\+And\+Jerk}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&particles, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree)
\begin{DoxyCompactList}\small\item\em Calculates both acceleration and jerk (time derivative of acceleration) for all particles. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{hermite_8cpp_a7c612e064cb2cb4ea9e56157f81839ff}{hermite\+Step}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&particles, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}tree, \mbox{\hyperlink{classQuadTree}{double}} \mbox{\hyperlink{classQuadTree}{dt}})
\begin{DoxyCompactList}\small\item\em One timestep of Hermite 4th order integration. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of Hermite 4th order predictor-\/corrector integrator. 

The Hermite method is widely used in astrophysical N-\/body simulations for its excellent energy conservation and ability to handle close encounters.

Key advantages\+:
\begin{DoxyItemize}
\item 4th order accuracy with only \texorpdfstring{$\sim$}{\string~}2 force evaluations per step
\item Superior energy conservation compared to symplectic integrators
\item Better handling of close encounters
\item Can use 2-\/3x larger timesteps than Yoshida for same accuracy
\end{DoxyItemize}

Reference\+: Makino \& Aarseth (1992), PASJ, 44, 141 

\doxysubsection{Function Documentation}
\Hypertarget{hermite_8cpp_a733b75759dd130ce95bc3015d292dea7}\label{hermite_8cpp_a733b75759dd130ce95bc3015d292dea7} 
\index{hermite.cpp@{hermite.cpp}!getAccelerationAndJerk@{getAccelerationAndJerk}}
\index{getAccelerationAndJerk@{getAccelerationAndJerk}!hermite.cpp@{hermite.cpp}}
\doxysubsubsection{\texorpdfstring{getAccelerationAndJerk()}{getAccelerationAndJerk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} get\+Acceleration\+And\+Jerk (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree }\end{DoxyParamCaption})}



Calculates both acceleration and jerk (time derivative of acceleration) for all particles. 

Uses Barnes-\/\+Hut algorithm for O(\+N log N) complexity. The jerk is calculated as the time derivative of gravitational acceleration\+:

For particle pair\+: da/dt = -\/G\texorpdfstring{$\ast$}{*}m \texorpdfstring{$\ast$}{*} \mbox{[}v/r³ -\/ 3\texorpdfstring{$\ast$}{*}(r·v)\texorpdfstring{$\ast$}{*}r/r⁵\mbox{]}

where r is position difference and v is velocity difference.


\begin{DoxyParams}{Parameters}
{\em particles} & Vector of particles \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} for hierarchical force calculation\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This function zeros acceleration and jerk before calculation 

Parallelized with Open\+MP 
\end{DoxyNote}
\Hypertarget{hermite_8cpp_a7c612e064cb2cb4ea9e56157f81839ff}\label{hermite_8cpp_a7c612e064cb2cb4ea9e56157f81839ff} 
\index{hermite.cpp@{hermite.cpp}!hermiteStep@{hermiteStep}}
\index{hermiteStep@{hermiteStep}!hermite.cpp@{hermite.cpp}}
\doxysubsubsection{\texorpdfstring{hermiteStep()}{hermiteStep()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} hermite\+Step (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



One timestep of Hermite 4th order integration. 

Performs one timestep using the Hermite 4th order predictor-\/corrector method.

Three-\/stage predictor-\/corrector scheme\+:

{\bfseries{Stage 1 -\/ Predictor\+:}} Extrapolate to t+dt using Taylor series with jerk\+:
\begin{DoxyItemize}
\item x\+\_\+p = x + v·dt + ½a·dt² + ⅙j·dt³
\item v\+\_\+p = v + a·dt + ½j·dt²
\end{DoxyItemize}

{\bfseries{Stage 2 -\/ Evaluator\+:}} Calculate forces at predicted positions

{\bfseries{Stage 3 -\/ Corrector\+:}} Update using average of old and new derivatives\+:
\begin{DoxyItemize}
\item v\+\_\+new = v + ½(a₀+a₁)·dt + 1/12(j₀-\/j₁)·dt²
\item x\+\_\+new = x + ½(v₀+v₁)·dt + 1/12(a₀-\/a₁)·dt²
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em particles} & \doxylink{classParticle}{Particle} array to integrate \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} for force calculation \\
\hline
{\em dt} & Timestep size\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Requires particles to have jerk initialized from previous step 

Thread-\/safe with Open\+MP parallelization 

Cost\+: \texorpdfstring{$\sim$}{\string~}2 force evaluations (predictor + corrector) 
\end{DoxyNote}
