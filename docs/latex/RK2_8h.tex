\doxysection{include/\+RK2.h File Reference}
\hypertarget{RK2_8h}{}\label{RK2_8h}\index{include/RK2.h@{include/RK2.h}}


Second-\/order Runge-\/\+Kutta (RK2) integrator.  


{\ttfamily \#include "{}barneshut.\+h"{}}\newline
{\ttfamily \#include "{}global.\+h"{}}\newline
Include dependency graph for RK2.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{RK2_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{RK2_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classQuadTree}{void}} \mbox{\hyperlink{RK2_8h_a325e55ed0fa7389880cdcf52e61c82ec}{RK2step}} (\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&, \mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}, \mbox{\hyperlink{classQuadTree}{double}})
\begin{DoxyCompactList}\small\item\em Performs one timestep using 2nd order Runge-\/\+Kutta method. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Second-\/order Runge-\/\+Kutta (RK2) integrator. 

Also known as the midpoint method or modified Euler method. Provides 2nd order accuracy with 2 force evaluations per step. 

\doxysubsection{Function Documentation}
\Hypertarget{RK2_8h_a325e55ed0fa7389880cdcf52e61c82ec}\label{RK2_8h_a325e55ed0fa7389880cdcf52e61c82ec} 
\index{RK2.h@{RK2.h}!RK2step@{RK2step}}
\index{RK2step@{RK2step}!RK2.h@{RK2.h}}
\doxysubsubsection{\texorpdfstring{RK2step()}{RK2step()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classQuadTree}{void}} RK2step (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::vector}}$<$ \mbox{\hyperlink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{std\+::shared\+\_\+ptr}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ $>$ \&}]{particles,  }\item[{\mbox{\hyperlink{classQuadTree}{Quad\+Tree}}$<$ \mbox{\hyperlink{classParticle}{Particle}} $>$ \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{\mbox{\hyperlink{classQuadTree}{double}}}]{dt }\end{DoxyParamCaption})}



Performs one timestep using 2nd order Runge-\/\+Kutta method. 

The RK2 method is a predictor-\/corrector scheme\+:
\begin{DoxyEnumerate}
\item Predict position at midpoint\+: x\+\_\+mid = x + v\texorpdfstring{$\ast$}{*}dt + \doxylink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{0.\+5}\texorpdfstring{$\ast$}{*}a\texorpdfstring{$\ast$}{*}dtÂ²
\item Evaluate acceleration at midpoint
\item Update velocity using average\+: v\+\_\+new = v + \doxylink{classQuadTree_a32ecd5218cb8f164aaaf0eaded7064c9}{0.\+5}\texorpdfstring{$\ast$}{*}(a\+\_\+0 + a\+\_\+mid)\texorpdfstring{$\ast$}{*}dt
\item Update position to x\+\_\+mid
\end{DoxyEnumerate}

This provides better accuracy than Euler\textquotesingle{}s method but is not symplectic, so it may have energy drift over long integrations.


\begin{DoxyParams}{Parameters}
{\em particles} & Vector of particles to integrate \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} for Barnes-\/\+Hut force calculation \\
\hline
{\em dt} & Timestep size\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Non-\/symplectic (not ideal for long-\/term orbit integration) 

Cost\+: 2 force evaluations per step 

Better suited for short-\/term high-\/accuracy calculations
\end{DoxyNote}
Performs one timestep using 2nd order Runge-\/\+Kutta method.

Steps\+:
\begin{DoxyEnumerate}
\item Calculate current acceleration
\item Predictor\+: advance to midpoint using current velocity and acceleration
\item Evaluate acceleration at predicted position
\item Corrector\+: update velocity using average of initial and midpoint accelerations
\end{DoxyEnumerate}


\begin{DoxyParams}{Parameters}
{\em particles} & \doxylink{classParticle}{Particle} vector \\
\hline
{\em tree} & \doxylink{classQuadTree}{Quad\+Tree} for force calculation \\
\hline
{\em dt} & Timestep \\
\hline
\end{DoxyParams}
