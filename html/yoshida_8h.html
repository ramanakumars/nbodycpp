<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nbodycpp: include/yoshida.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nbodycpp<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">N-body solver with a QuadTree and Barnes-Hut algorithm written in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">yoshida.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Yoshida 4th order symplectic integrator.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="barneshut_8h_source.html">barneshut.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for yoshida.h:</div>
<div class="dyncontent">
<div class="center"><img src="yoshida_8h__incl.png" border="0" usemap="#ainclude_2yoshida_8h" alt=""/></div>
<map name="ainclude_2yoshida_8h" id="ainclude_2yoshida_8h">
<area shape="rect" title="Yoshida 4th order symplectic integrator." alt="" coords="277,5,413,31"/>
<area shape="rect" href="global_8h.html" title="Global constants, includes, and type definitions for N&#45;body simulation." alt="" coords="391,372,466,397"/>
<area shape="poly" title=" " alt="" coords="341,32,319,88,309,125,305,163,305,239,307,259,314,278,337,313,367,341,397,363,394,367,364,345,333,316,309,281,302,261,299,239,299,163,303,124,313,86,336,30"/>
<area shape="rect" href="barneshut_8h.html" title="Barnes&#45;Hut algorithm for hierarchical N&#45;body force calculation." alt="" coords="363,79,462,104"/>
<area shape="poly" title=" " alt="" coords="358,29,394,67,390,70,354,33"/>
<area shape="rect" title=" " alt="" coords="5,445,71,471"/>
<area shape="poly" title=" " alt="" coords="392,394,260,415,85,448,84,443,259,410,391,389"/>
<area shape="rect" title=" " alt="" coords="95,445,157,471"/>
<area shape="poly" title=" " alt="" coords="392,397,171,448,169,442,391,392"/>
<area shape="rect" title=" " alt="" coords="181,445,244,471"/>
<area shape="poly" title=" " alt="" coords="395,400,258,445,256,440,393,395"/>
<area shape="rect" title=" " alt="" coords="268,445,331,471"/>
<area shape="poly" title=" " alt="" coords="409,400,334,441,332,436,407,395"/>
<area shape="rect" title=" " alt="" coords="355,445,411,471"/>
<area shape="poly" title=" " alt="" coords="423,399,400,435,396,432,419,396"/>
<area shape="rect" title=" " alt="" coords="435,445,513,471"/>
<area shape="poly" title=" " alt="" coords="438,396,462,432,457,435,434,399"/>
<area shape="rect" title=" " alt="" coords="537,445,617,471"/>
<area shape="poly" title=" " alt="" coords="454,395,541,437,539,442,451,400"/>
<area shape="rect" title=" " alt="" coords="641,445,726,471"/>
<area shape="poly" title=" " alt="" coords="467,394,630,439,628,444,466,399"/>
<area shape="rect" title=" " alt="" coords="750,445,865,471"/>
<area shape="poly" title=" " alt="" coords="467,390,736,441,736,446,466,396"/>
<area shape="rect" title=" " alt="" coords="889,445,952,471"/>
<area shape="poly" title=" " alt="" coords="466,387,639,406,755,422,876,443,875,448,754,427,639,411,466,392"/>
<area shape="poly" title=" " alt="" coords="406,106,392,127,381,153,379,165,381,177,400,278,423,358,418,360,395,279,375,178,374,165,375,151,387,124,401,103"/>
<area shape="rect" href="quadtree_8h.html" title="QuadTree spatial data structure for Barnes&#45;Hut algorithm." alt="" coords="391,152,483,177"/>
<area shape="poly" title=" " alt="" coords="419,103,431,138,426,140,414,105"/>
<area shape="rect" href="particle_8h.html" title="Particle class for N&#45;body simulation." alt="" coords="513,152,595,177"/>
<area shape="poly" title=" " alt="" coords="437,102,520,143,518,148,434,106"/>
<area shape="poly" title=" " alt="" coords="437,178,431,226,429,298,430,358,425,358,424,298,426,225,432,177"/>
<area shape="rect" href="bounds_8h.html" title="Axis&#45;aligned bounding box for spatial queries." alt="" coords="441,225,523,251"/>
<area shape="poly" title=" " alt="" coords="446,176,470,212,465,215,442,179"/>
<area shape="poly" title=" " alt="" coords="480,252,440,360,435,358,475,250"/>
<area shape="rect" href="vector2D_8h.html" title="2D vector class for N&#45;body simulation" alt="" coords="491,299,585,324"/>
<area shape="poly" title=" " alt="" coords="493,249,523,286,518,289,489,253"/>
<area shape="poly" title=" " alt="" coords="522,326,460,367,457,362,519,322"/>
<area shape="poly" title=" " alt="" coords="565,176,584,204,603,243,609,264,611,285,608,306,599,326,574,350,544,367,511,377,480,383,479,378,510,372,542,362,571,346,594,322,603,305,606,285,603,265,598,244,579,207,561,179"/>
<area shape="poly" title=" " alt="" coords="544,180,505,218,502,214,540,176"/>
<area shape="poly" title=" " alt="" coords="555,178,543,285,538,285,550,177"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="yoshida_8h__dep__incl.png" border="0" usemap="#ainclude_2yoshida_8hdep" alt=""/></div>
<map name="ainclude_2yoshida_8hdep" id="ainclude_2yoshida_8hdep">
<area shape="rect" title="Yoshida 4th order symplectic integrator." alt="" coords="92,5,228,31"/>
<area shape="rect" href="interactions_8cpp.html" title="Implementation of particle interactions and collision handling." alt="" coords="5,79,155,104"/>
<area shape="poly" title=" " alt="" coords="139,42,95,80,91,76,135,38"/>
<area shape="rect" href="yoshida_8cpp.html" title="Implementation of Yoshida 4th order symplectic integrator." alt="" coords="179,79,301,104"/>
<area shape="poly" title=" " alt="" coords="185,38,229,76,225,80,181,42"/>
</map>
</div>
</div>
<p><a href="yoshida_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af6acf52885dab1a8cd2b946a332e3043" id="r_af6acf52885dab1a8cd2b946a332e3043"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yoshida_8h.html#af6acf52885dab1a8cd2b946a332e3043">drift</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &amp;, <a class="el" href="classQuadTree.html">double</a>)</td></tr>
<tr class="memdesc:af6acf52885dab1a8cd2b946a332e3043"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift step: update positions using current velocities.  <br /></td></tr>
<tr class="separator:af6acf52885dab1a8cd2b946a332e3043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a76e4aee070737822a9818b703ff584" id="r_a0a76e4aee070737822a9818b703ff584"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yoshida_8h.html#a0a76e4aee070737822a9818b703ff584">kick</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &amp;, <a class="el" href="classQuadTree.html">double</a>)</td></tr>
<tr class="memdesc:a0a76e4aee070737822a9818b703ff584"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kick step: update velocities using current accelerations.  <br /></td></tr>
<tr class="separator:a0a76e4aee070737822a9818b703ff584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54d2dd2f03a97e82236e5499f12ad04b" id="r_a54d2dd2f03a97e82236e5499f12ad04b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadTree.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yoshida_8h.html#a54d2dd2f03a97e82236e5499f12ad04b">yoshidaStep</a> (<a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;, <a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *, <a class="el" href="classQuadTree.html">double</a>)</td></tr>
<tr class="memdesc:a54d2dd2f03a97e82236e5499f12ad04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one timestep using Yoshida 4th order symplectic method.  <br /></td></tr>
<tr class="separator:a54d2dd2f03a97e82236e5499f12ad04b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Yoshida coefficients</div></td></tr>
<tr class="memitem:a4088c31414435cc3ae33862b24dab47b" id="r_a4088c31414435cc3ae33862b24dab47b"><td class="memItemLeft" align="right" valign="top"><a id="a4088c31414435cc3ae33862b24dab47b" name="a4088c31414435cc3ae33862b24dab47b"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>w0</b> = -<a class="el" href="classQuadTree.html">pow</a>(2.0, 1.0 / 3.0) / (2.0 - <a class="el" href="classQuadTree.html">pow</a>(2.0, 1.0 / 3.0))</td></tr>
<tr class="memdesc:a4088c31414435cc3ae33862b24dab47b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight 0. <br /></td></tr>
<tr class="separator:a4088c31414435cc3ae33862b24dab47b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad79f685408a628c34e6c0389d013e8c9" id="r_ad79f685408a628c34e6c0389d013e8c9"><td class="memItemLeft" align="right" valign="top"><a id="ad79f685408a628c34e6c0389d013e8c9" name="ad79f685408a628c34e6c0389d013e8c9"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>w1</b> = 1.0 / (2.0 - <a class="el" href="classQuadTree.html">pow</a>(2.0, 1.0 / 3.0))</td></tr>
<tr class="memdesc:ad79f685408a628c34e6c0389d013e8c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight 1. <br /></td></tr>
<tr class="separator:ad79f685408a628c34e6c0389d013e8c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3800b4c89b0f78f7e8c9b96534f98b52" id="r_a3800b4c89b0f78f7e8c9b96534f98b52"><td class="memItemLeft" align="right" valign="top"><a id="a3800b4c89b0f78f7e8c9b96534f98b52" name="a3800b4c89b0f78f7e8c9b96534f98b52"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>c1</b> = <a class="el" href="yoshida_8h.html#ad79f685408a628c34e6c0389d013e8c9">w1</a> / 2.0</td></tr>
<tr class="memdesc:a3800b4c89b0f78f7e8c9b96534f98b52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift coefficient 1. <br /></td></tr>
<tr class="separator:a3800b4c89b0f78f7e8c9b96534f98b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf46f6ce4661ff8de72c4f95026a1c6" id="r_abcf46f6ce4661ff8de72c4f95026a1c6"><td class="memItemLeft" align="right" valign="top"><a id="abcf46f6ce4661ff8de72c4f95026a1c6" name="abcf46f6ce4661ff8de72c4f95026a1c6"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>c2</b> = (<a class="el" href="yoshida_8h.html#a4088c31414435cc3ae33862b24dab47b">w0</a> + <a class="el" href="yoshida_8h.html#ad79f685408a628c34e6c0389d013e8c9">w1</a>) / 2.0</td></tr>
<tr class="memdesc:abcf46f6ce4661ff8de72c4f95026a1c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift coefficient 2. <br /></td></tr>
<tr class="separator:abcf46f6ce4661ff8de72c4f95026a1c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f1572d06172ab1a7eb50e47725f94b6" id="r_a6f1572d06172ab1a7eb50e47725f94b6"><td class="memItemLeft" align="right" valign="top"><a id="a6f1572d06172ab1a7eb50e47725f94b6" name="a6f1572d06172ab1a7eb50e47725f94b6"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>c3</b> = <a class="el" href="yoshida_8h.html#abcf46f6ce4661ff8de72c4f95026a1c6">c2</a></td></tr>
<tr class="memdesc:a6f1572d06172ab1a7eb50e47725f94b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift coefficient 3. <br /></td></tr>
<tr class="separator:a6f1572d06172ab1a7eb50e47725f94b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5809b2c1b216c86cfb5de0e85303c3" id="r_a5f5809b2c1b216c86cfb5de0e85303c3"><td class="memItemLeft" align="right" valign="top"><a id="a5f5809b2c1b216c86cfb5de0e85303c3" name="a5f5809b2c1b216c86cfb5de0e85303c3"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>c4</b> = <a class="el" href="yoshida_8h.html#a3800b4c89b0f78f7e8c9b96534f98b52">c1</a></td></tr>
<tr class="memdesc:a5f5809b2c1b216c86cfb5de0e85303c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift coefficient 4. <br /></td></tr>
<tr class="separator:a5f5809b2c1b216c86cfb5de0e85303c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92da0085219eb1150d80f17b163d73ea" id="r_a92da0085219eb1150d80f17b163d73ea"><td class="memItemLeft" align="right" valign="top"><a id="a92da0085219eb1150d80f17b163d73ea" name="a92da0085219eb1150d80f17b163d73ea"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>d1</b> = <a class="el" href="yoshida_8h.html#ad79f685408a628c34e6c0389d013e8c9">w1</a></td></tr>
<tr class="memdesc:a92da0085219eb1150d80f17b163d73ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kick coefficient 1. <br /></td></tr>
<tr class="separator:a92da0085219eb1150d80f17b163d73ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab3a9b8bd1a9fa68cd1578660f31b70d" id="r_aab3a9b8bd1a9fa68cd1578660f31b70d"><td class="memItemLeft" align="right" valign="top"><a id="aab3a9b8bd1a9fa68cd1578660f31b70d" name="aab3a9b8bd1a9fa68cd1578660f31b70d"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>d2</b> = <a class="el" href="yoshida_8h.html#a4088c31414435cc3ae33862b24dab47b">w0</a></td></tr>
<tr class="memdesc:aab3a9b8bd1a9fa68cd1578660f31b70d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kick coefficient 2. <br /></td></tr>
<tr class="separator:aab3a9b8bd1a9fa68cd1578660f31b70d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6567c34d7f8aa51398c8a7ce3c8c416" id="r_ac6567c34d7f8aa51398c8a7ce3c8c416"><td class="memItemLeft" align="right" valign="top"><a id="ac6567c34d7f8aa51398c8a7ce3c8c416" name="ac6567c34d7f8aa51398c8a7ce3c8c416"></a>
<a class="el" href="classQuadTree.html">const</a> <a class="el" href="classQuadTree.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><b>d3</b> = <a class="el" href="yoshida_8h.html#ad79f685408a628c34e6c0389d013e8c9">w1</a></td></tr>
<tr class="memdesc:ac6567c34d7f8aa51398c8a7ce3c8c416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kick coefficient 3. <br /></td></tr>
<tr class="separator:ac6567c34d7f8aa51398c8a7ce3c8c416"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Yoshida 4th order symplectic integrator. </p>
<p>Implements the Yoshida symplectic integrator, a composition method that achieves 4th order accuracy while preserving the symplectic structure of Hamiltonian systems.</p>
<p>This results in excellent long-term energy conservation, making it ideal for orbital dynamics and secular evolution studies.</p>
<p>Reference: Yoshida (1990), Physics Letters A, 150, 262 </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af6acf52885dab1a8cd2b946a332e3043" name="af6acf52885dab1a8cd2b946a332e3043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6acf52885dab1a8cd2b946a332e3043">&#9670;&#160;</a></span>drift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> drift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drift step: update positions using current velocities. </p>
<p>x_new = x_old + v * dt</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td><a class="el" href="classParticle.html" title="Represents a particle in the N-body simulation.">Particle</a> vector </td></tr>
    <tr><td class="paramname">dt</td><td>Timestep (may be fractional for substeps) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0a76e4aee070737822a9818b703ff584" name="a0a76e4aee070737822a9818b703ff584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a76e4aee070737822a9818b703ff584">&#9670;&#160;</a></span>kick()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> kick </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kick step: update velocities using current accelerations. </p>
<p>v_new = v_old + a * dt</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td><a class="el" href="classParticle.html" title="Represents a particle in the N-body simulation.">Particle</a> vector </td></tr>
    <tr><td class="paramname">dt</td><td>Timestep (may be fractional for substeps) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a54d2dd2f03a97e82236e5499f12ad04b" name="a54d2dd2f03a97e82236e5499f12ad04b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54d2dd2f03a97e82236e5499f12ad04b">&#9670;&#160;</a></span>yoshidaStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadTree.html">void</a> yoshidaStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::vector</a>&lt; <a class="el" href="classQuadTree.html#a32ecd5218cb8f164aaaf0eaded7064c9">std::shared_ptr</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">QuadTree</a>&lt; <a class="el" href="classParticle.html">Particle</a> &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuadTree.html">double</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform one timestep using Yoshida 4th order symplectic method. </p>
<p>Composition of drift-kick-drift stages with special coefficients:</p><ul>
<li>Drift(c1*dt) → Kick(d1*dt) → Drift(c2*dt) → ...</li>
<li>Total of 4 drift and 3 kick substeps</li>
<li>Coefficients chosen to cancel error terms up to 4th order</li>
</ul>
<p>Properties:</p><ul>
<li>Symplectic (preserves phase space volume)</li>
<li>Time-reversible</li>
<li>4th order accuracy: error ~ O(dt⁵)</li>
<li>Excellent long-term energy conservation</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td>Vector of particles to integrate </td></tr>
    <tr><td class="paramname">tree</td><td><a class="el" href="classQuadTree.html" title="Hierarchical spatial partitioning tree for 2D N-body simulation.">QuadTree</a> for Barnes-Hut force calculation </td></tr>
    <tr><td class="paramname">dt</td><td>Timestep size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Requires 4 force evaluations per step </dd>
<dd>
Best for long-term orbital integration </dd>
<dd>
May struggle with close encounters</dd></dl>
<p>Perform one timestep using Yoshida 4th order symplectic method.</p>
<p>Performs composition of drift and kick operations with specially chosen coefficients for 4th order accuracy while maintaining symplectic properties. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
